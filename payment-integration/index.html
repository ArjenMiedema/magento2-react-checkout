
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../assets/img/hyva-logo-360.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.6">
    
    
      
        <title>Payment Integration - Hyvä Themes - Hyvä Checkout</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.7fa14f5b.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#payment-integration" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Hyvä Themes - Hyvä Checkout" class="md-header__button md-logo" aria-label="Hyvä Themes - Hyvä Checkout" data-md-component="logo">
      
  <img src="../assets/img/hyva-logo-360.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Hyvä Themes - Hyvä Checkout
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Payment Integration
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Hyvä Themes - Hyvä Checkout" class="md-nav__button md-logo" aria-label="Hyvä Themes - Hyvä Checkout" data-md-component="logo">
      
  <img src="../assets/img/hyva-logo-360.png" alt="logo">

    </a>
    Hyvä Themes - Hyvä Checkout
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../how_to_use/" class="md-nav__link">
        How to use
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../customize/" class="md-nav__link">
        How to customize
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../build/" class="md-nav__link">
        How can build
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../at_a_glance/" class="md-nav__link">
        Checkout - at a glance
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../i18n/" class="md-nav__link">
        Internationalization
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Payment Integration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Payment Integration
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#payment-supports" class="md-nav__link">
    Payment Supports
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-can-we-collect-the-payment-configurations" class="md-nav__link">
    How can we collect the payment configurations?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-payment-renderer" class="md-nav__link">
    Custom Payment Renderer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-interact-with-place-order" class="md-nav__link">
    How To Interact With Place Order
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#payment-supports" class="md-nav__link">
    Payment Supports
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-can-we-collect-the-payment-configurations" class="md-nav__link">
    How can we collect the payment configurations?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-payment-renderer" class="md-nav__link">
    Custom Payment Renderer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-interact-with-place-order" class="md-nav__link">
    How To Interact With Place Order
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="payment-integration">Payment Integration</h1>
<p>In Hyvä Checkout, the payment options will be shown as radio inputs by default. You can choose the option and place the order, and everything works out of the box.</p>
<p>But showing just a radio input box and allowing you to select/deselect them is not what you needed for all payment options. Some payment methods need different behaviour. Also, some payment methods need a separate flow when we perform the "place order" action. To help you out in such cases, Hyvä Checkout already possesses some superpowers which we will see in a short time.</p>
<h2 id="payment-supports">Payment Supports</h2>
<p>Payment methods integration is in progress. We don't have any plans to keep payment components as part of Hyvä Checkout. But, we will be maintaining separate payment repositories which will hold the custom payment method components which you can use with Hyvä Checkout seamlessly.</p>
<p>Below, we are listing the payment repositories, and each repository will have specific instructions about its usage.</p>
<ul>
<li><a href="https://github.com/hyva-themes/magento2-hyva-checkout-payone">hyva-themes/magento2-hyva-checkout-payone</a></li>
</ul>
<p>We are open to contributions here as the payment options available out there are many, and you all can help you out to grow the above list.</p>
<hr />
<p>Now, it is time to get to know some technical aspect of the payment integration which you can do with Hyvä Checkout.</p>
<h2 id="how-can-we-collect-the-payment-configurations">How can we collect the payment configurations?</h2>
<p>Depending upon the payment methods, you may have some special configuration settings in your store. Usually, you do this under <code>Stores &gt; Configuration</code>. If you are familiar with the default Magento 2 checkout page, then you may know that Magento 2 passes this configuration via a global variable which you can find at <code>window.checkoutConfig</code>.</p>
<p>To collect these checkout configurations, we have a ViewModel available in the module. You can find this ViewModel in the path <code>src/ViewModel/CheckoutConfigProvider.php</code>. So to make payment configurations available to the checkout page, you need to do the following steps.</p>
<ol>
<li>
<p>Include the ViewModel via the layout file.</p>
<p>File: <code>src/view/frontend/layout/hyvacheckout_checkout_index.xml</code></p>
<pre><code>&lt;?xml version="1.0"?&gt;
&lt;page xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" layout="1column" xsi:noNamespaceSchemaLocation="urn:magento:framework:View/Layout/etc/page_configuration.xsd"&gt;
    ...
    &lt;body&gt;
        &lt;referenceContainer name="content"&gt;
            &lt;block name="checkout.container" cacheable="false" template="Hyva_Checkout::react-container.phtml"&gt;
                &lt;arguments&gt;
                    ...
                    &lt;argument name="checkout_config_provider" xsi:type="object"&gt;Hyva\Checkout\ViewModel\CheckoutConfigProvider&lt;/argument&gt;
                &lt;/arguments&gt;
            &lt;/block&gt;
        &lt;/referenceContainer&gt;
        ...
    &lt;/body&gt;
&lt;/page&gt;
</code></pre>
</li>
<li>
<p>Pass the payment configuration via <code>data-payment</code> attribute.</p>
<p>File: <code>src/view/frontend/templates/react-container.phtml</code></p>
<pre><code>&lt;?php
...
/** @var \Magento\Framework\Escaper $escaper */
/** @var \Hyva\Checkout\ViewModel\CheckoutConfigProvider $configProvider */
$configProvider = $block-&gt;getCheckoutConfigProvider();
...
?&gt;
&lt;div
    id="react-checkout"
    ...
    data-payment="&lt;?= $escaper-&gt;escapeHtmlAttr($configProvider-&gt;getConfig())  ?&gt;"
&gt;
...
&lt;/div&gt;
</code></pre>
</li>
</ol>
<p>With these changes in place, now the react app has access to the payment configurations, and it can be used in the application according to your need.</p>
<h2 id="custom-payment-renderer">Custom Payment Renderer</h2>
<p>As already stated, by default, all payment methods appear as a radio input. But Hyvä Checkout allows using a custom renderer for any payment methods. All you need to do is add your custom payment method component in the <code>src/reactapp/src/components/paymentMethod/customRenderers.js</code> file. This js file exports an empty object (<code>{}</code>) by default. But if you specify your custom payment method component, then the react app will use your custom component in order to render the payment method. For example,</p>
<p>File: <code>src/reactapp/src/components/paymentMethod/customRenderers.js</code></p>
<pre><code>import CreditCard from '../payone/components/creditCard/CreditCard';

export default {
  payone_creditcard: CreditCard,
};
</code></pre>
<p>Here <code>payone_creditcard</code> is the payment method code and <code>CreditCard</code> is the custom payment method component.</p>
<h2 id="how-to-interact-with-place-order">How To Interact With Place Order</h2>
<p>If your payment method needs some special functions to carry out or if your payment method wants to alter the behaviour of place an order, then Hyvä Checkout provides some features out of the box to help you out.</p>
<p>File: <code>src/reactapp/src/context/Form/CheckoutFormProvider.jsx</code></p>
<pre><code>...
function CheckoutFormProvider({ children }) {
  ...
  const [paymentActionList, setPaymentActions] = useState({});
  ...
  const registerPaymentAction = useCallback(
    (paymentMethodCode, paymentMethodAction) =&gt; {
      setPaymentActions(actions =&gt; ({
        ...actions,
        [paymentMethodCode]: paymentMethodAction,
      }));
    },
    [setPaymentActions]
  );
  ...
}
...
</code></pre>
<p>Here <code>CheckoutFormProvider</code> is one of the super parent components that wraps react app. As you can see in the code it has a state <code>paymentActionList</code> which can be populated with any custom payment action you want to perform when the "place order" action happens. See the <code>registerPaymentAction</code> function. This function is available for all the child components and thus a custom payment method component can use it to register a custom "place order" behaviour.</p>
<p>Suppose you have a custom payment method component <code>PayOneCreditCard</code> and it looks like below</p>
<pre><code>function PayOneCreditCard({ method, selected, actions }) {
  const { registerPaymentAction } = useCheckoutFormContext();

  // custom &quot;place order&quot; submit action
  const paymentSubmitHandler = useCallback(
    async values =&gt; {
      console.log({ values });
      alert('yeeeha');
    },
    []
  );

  // registering custom &quot;place order&quot; action for the payment method
  useEffect(() =&gt; {
    registerPaymentAction('payone_creditcard', paymentSubmitHandler);
  }, [registerPaymentAction, paymentSubmitHandler]);

  return (
    // custom payment method JSX here
  );
}
</code></pre>
<p>So in the <code>useEffect</code>, we are registering custom place order action for the payment method. Now when the user opted <code>payone_creditcard</code> as the payment option and then click on the "Place Order" button, it will use the <code>paymentSubmitHandler</code> in this component to process the order. So now the payment method needs to convert the quote to order according to its need and then redirect the user to the success page.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../i18n/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Internationalization
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
    
  </body>
</html>